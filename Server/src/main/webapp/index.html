<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <title>Server UI - Index</title>
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
        <div class="container">
            <div class="header card">
                <div class="logo">SU</div>
                <div style="flex:1">
                    <div class="title">Server control panel</div>
                    <div class="small muted">Interactúa con los endpoints del servidor</div>
                </div>
                <div style="text-align:right;min-width:260px;">
                    <div id="healthStatus" class="health-unset">...</div>
                    <div style="margin-top:6px;"><a class="btn secondary" href="logout">Cerrar sesión</a></div>
                </div>
            </div>

            <div class="card">
                <div class="grid">
                    <div class="card">
                        <h3>Lecturas por sensor</h3>
                        <p class="small">Interfaz para <code>/sensor/readings</code></p>
                        <div class="controls"><a class="btn" href="sensor_readings.html">Abrir</a></div>
                    </div>
                    <div class="card">
                        <h3>Consulta flexible</h3>
                        <p class="small">Interfaz para <code>/api/readings/query</code></p>
                        <div class="controls"><a class="btn" href="readings_query.html">Abrir</a></div>
                    </div>
                    <!-- Removed legacy GetData/GetDataByDate/SetData UIs -->
                        <div class="card">
                            <h3>Administración de usuarios</h3>
                            <p class="small">Crear y listar usuarios (admin)</p>
                            <div class="controls"><a class="btn" href="users.html">Usuarios</a> <a class="btn" href="create_user.html">Crear</a></div>
                        </div>
                        <div class="card">
                            <h3>Suscripciones</h3>
                            <p class="small">Ver, agregar y quitar topics suscritos</p>
                            <div class="controls"><a class="btn" href="subscriptions.html">Abrir</a></div>
                        </div>
                        <div class="card">
                            <h3>Rangos</h3>
                            <p class="small">Configurar rangos seguros por parámetro</p>
                            <div class="controls"><a class="btn" href="ranges.html">Abrir</a></div>
                        </div>
                        <div class="card">
                            <h3>Alarmas</h3>
                            <p class="small">Ver alarmas activas y cerradas</p>
                            <div class="controls"><a class="btn" href="alarms.html">Abrir</a></div>
                        </div>
                        <div class="card">
                            <h3>Publicar alerta</h3>
                            <p class="small">Enviar alertas manualmente a una estación</p>
                            <div class="controls"><a class="btn" href="publish_alert.html">Abrir</a></div>
                        </div>
                </div>
            </div>

            <div class="card">
                <h3>Estado en tiempo real</h3>
                <div class="grid" style="grid-template-columns: 300px 1fr; gap:12px;">
                    <div class="card">
                        <h4>Estaciones conectadas</h4>
                        <div id="liveStations" class="small muted">Cargando…</div>
                    </div>
                    <div class="card">
                        <h4>Mensajes en tiempo real</h4>
                        <div id="liveMessages" class="small muted">Cargando…</div>
                    </div>
                </div>
            </div>
        </div>
                <script src="js/app.js"></script>
                <script>
                    // start health polling every 10 seconds and live feed every 2 seconds
                    try { startHealthPolling(10); } catch(e) { console.warn('health polling failed', e); }
                    try { startLiveFeed(2); } catch(e) { console.warn('live feed failed', e); }
                </script>
    </body>
</html>